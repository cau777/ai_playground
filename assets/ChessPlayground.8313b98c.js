import{g as $,t as m,h as B,j as y,i as s,c as p,a as b,f as E,k as A,r as L,I as q,d as z,l as G}from"./entry-client.9986a708.js";import{N as U}from"./NavControls.aeb6e851.js";import{C as j}from"./ChessPiece.ffad8b09.js";import{c as D,a as H}from"./server-interface.712c5e0a.js";import{b as P}from"./LanguagesContext.ddaf9c98.js";const K=m('<svg viewBox="0 0 100 100" width="100%"><circle cx="50" cy="50" r="15" fill="black"></circle></svg>'),O=()=>$(K),Q=m('<div class="select-none grid grid-cols-8 grid-rows-8 h-[30rem] w-[30rem] border-t-2 border-r-2 bg-primary-400"></div>'),F=m('<div class="absolute t-0 l-0 w-full h-full z-10 opacity-20"></div>'),J=m('<div class="relative border-l-2 border-b-2 "><!#><!/><div class="p-1"></div></div>');function V(e){let n=7-Math.floor(e/8),l=e%8;return String.fromCodePoint(65+l)+(n+1)}const W=e=>{let n=()=>{let o=e.board.replaceAll(`
`,"").replaceAll(" ","").split("");if(o.length!=64)throw new RangeError("Malformed literal: invalid size");return o},[l,a]=y();function f(o,c,r){if(!!e.interactive)if(r===void 0){if(o==="_")return;a({notation:c})}else r.notation===c||e.onMove(r.notation,c),a(void 0)}return(()=>{const o=$(Q);return s(o,p(q,{get each(){return n()},children:(c,r)=>{let t=V(r),g=(Math.floor(r/8)+r%8)%2==0,d=()=>{let i=l();return i!==void 0&&e.possible.get(i.notation)?.has(t)===!0},_=()=>l()?.notation===t;return(()=>{const i=$(J),v=i.firstChild,[h,x]=b(v.nextSibling),S=h.nextSibling;return i.$$click=()=>f(c(),t,l()),i.classList.toggle("bg-primary-50",g),s(i,p(E,{get when(){return d()},keyed:!1,get children(){const u=$(F);return s(u,p(O,{})),u}}),h,x),s(S,p(j,{get notation(){return c()}})),A(()=>i.classList.toggle("bg-primary-200",!!_())),L(),i})()}})),o})()};B(["click"]);const X=m('<div class="leading-tight min-h-[5em]"><!#><!/><p><!#><!/>: <!#><!/></p><p></p></div>'),Y=m("<p><!#><!/>: <!#><!/> </p>"),Z=e=>{let n=P(),l=()=>n[e.result??"gameResultUndefined"];return(()=>{const a=$(X),f=a.firstChild,[o,c]=b(f.nextSibling),r=o.nextSibling,t=r.firstChild,[g,d]=b(t.nextSibling),_=g.nextSibling,i=_.nextSibling,[v,h]=b(i.nextSibling),x=r.nextSibling;return s(a,(()=>{const S=z(()=>!!e.opening);return()=>S()&&(()=>{const u=$(Y),I=u.firstChild,[C,k]=b(I.nextSibling),N=C.nextSibling,R=N.nextSibling,[w,T]=b(R.nextSibling);return w.nextSibling,s(u,()=>n.opening,C,k),s(u,()=>e.opening,w,T),u})()})(),o,c),s(r,()=>n.gameResult,g,d),s(r,l,v,h),s(x,()=>e.playerTurn?n.playerTurn:n.aiTurn),a})()},ee=m('<div class="m-12"><h1 class="text-3xl font-black text-primary-100 mb-3"></h1><!#><!/><!#><!/></div>'),te=`
r n b q k b n r
p p p p p p p p
_ _ _ _ _ _ _ _
_ _ _ _ _ _ _ _
_ _ _ _ _ _ _ _
_ _ _ _ _ _ _ _
P P P P P P P P
R N B Q K B N R`;function M(e){let n=new Map;for(let[l,a]of e)n.has(l)||n.set(l,new Set),n.get(l).add(a);return n}const ae=()=>{let[e,n]=y(),[l,a]=y(!1),f=()=>e()?.board??te,o=P();G(()=>{D(!0).then(t=>{n({board:t.board,gameId:t.game_id,possible:M(t.possible),state:t.game_state,opening:t.opening})})});async function c(t,g,d){if(l()||d===void 0||!d.possible.get(t)?.has(g))return;a(!0);let _=await H(d.gameId,t,g);n({gameId:d.gameId,possible:M(_.possible),board:_.board,state:_.game_state,opening:_.opening}),a(!1)}let r=()=>e()?.state==="gameResultUndefined"&&!l();return p(U,{get children(){const t=$(ee),g=t.firstChild,d=g.nextSibling,[_,i]=b(d.nextSibling),v=_.nextSibling,[h,x]=b(v.nextSibling);return s(g,()=>o.title),s(t,p(Z,{get opening(){return e()?.opening},get result(){return e()?.state},get playerTurn(){return!l()}}),_,i),s(t,p(W,{get interactive(){return r()},get board(){return f()},get possible(){return e()?.possible??new Map},onMove:(S,u)=>c(S,u,e())}),h,x),t}})};export{ae as C};
