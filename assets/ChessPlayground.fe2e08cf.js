import{g as m,t as b,h as B,j as y,i as o,c as u,a as $,f as E,k as A,r as L,I as q,d as z,l as G}from"./entry-client.9c4986bc.js";import{N as U}from"./NavControls.d6e7c214.js";import{C as j}from"./ChessPiece.24f725db.js";import{P as D,c as H,a as K}from"./PlaygroundContainer.19b9a5ab.js";import{b as M}from"./LanguagesContext.ad3fefa0.js";const O=b('<svg viewBox="0 0 100 100" width="100%"><circle cx="50" cy="50" r="15" fill="black"></circle></svg>'),Q=()=>m(O),F=b('<div class="select-none grid grid-cols-8 grid-rows-8 max-h-[30rem] max-w-[30rem] border-t-2 border-r-2 bg-primary-400"></div>'),J=b('<div class="absolute t-0 l-0 w-full h-full z-10 opacity-20"></div>'),V=b('<div class="relative border-l-2 border-b-2 "><!#><!/><div class="p-1"></div></div>');function W(e){let n=7-Math.floor(e/8),r=e%8;return String.fromCodePoint(65+r)+(n+1)}const X=e=>{let n=()=>{let s=e.board.replaceAll(`
`,"").replaceAll(" ","").split("");if(s.length!=64)throw new RangeError("Malformed literal: invalid size");return s},[r,i]=y();function f(s,c,l){if(!!e.interactive)if(l===void 0){if(s==="_")return;i({notation:c})}else l.notation===c||e.onMove(l.notation,c),i(void 0)}return(()=>{const s=m(F);return o(s,u(q,{get each(){return n()},children:(c,l)=>{let t=W(l),_=(Math.floor(l/8)+l%8)%2==0,g=()=>{let a=r();return a!==void 0&&e.possible.get(a.notation)?.has(t)===!0},d=()=>r()?.notation===t;return(()=>{const a=m(V),v=a.firstChild,[h,x]=$(v.nextSibling),S=h.nextSibling;return a.$$click=()=>f(c(),t,r()),a.classList.toggle("bg-primary-50",_),o(a,u(E,{get when(){return g()},keyed:!1,get children(){const p=m(J);return o(p,u(Q,{})),p}}),h,x),o(S,u(j,{get notation(){return c()}})),A(()=>a.classList.toggle("bg-primary-200",!!d())),L(),a})()}})),s})()};B(["click"]);const Y=b('<div class="leading-tight min-h-[5em]"><!#><!/><p><!#><!/>: <!#><!/></p><p></p></div>'),Z=b("<p><!#><!/>: <!#><!/> </p>"),ee=e=>{let n=M(),r=()=>n[e.result??"gameResultUndefined"];return(()=>{const i=m(Y),f=i.firstChild,[s,c]=$(f.nextSibling),l=s.nextSibling,t=l.firstChild,[_,g]=$(t.nextSibling),d=_.nextSibling,a=d.nextSibling,[v,h]=$(a.nextSibling),x=l.nextSibling;return o(i,(()=>{const S=z(()=>!!e.opening);return()=>S()&&(()=>{const p=m(Z),I=p.firstChild,[C,k]=$(I.nextSibling),N=C.nextSibling,R=N.nextSibling,[w,T]=$(R.nextSibling);return w.nextSibling,o(p,()=>n.opening,C,k),o(p,()=>e.opening,w,T),p})()})(),s,c),o(l,()=>n.gameResult,_,g),o(l,r,v,h),o(x,()=>e.playerTurn?n.playerTurn:n.aiTurn),i})()},te=b('<h1 class="text-3xl font-black text-primary-100 mb-3"></h1>'),ne=`
r n b q k b n r
p p p p p p p p
_ _ _ _ _ _ _ _
_ _ _ _ _ _ _ _
_ _ _ _ _ _ _ _
_ _ _ _ _ _ _ _
P P P P P P P P
R N B Q K B N R`;function P(e){let n=new Map;for(let[r,i]of e)n.has(r)||n.set(r,new Set),n.get(r).add(i);return n}const oe=()=>{let[e,n]=y(),[r,i]=y(!1),f=()=>e()?.board??ne,s=M();G(()=>{H(!0).then(t=>{n({board:t.board,gameId:t.game_id,possible:P(t.possible),state:t.game_state,opening:t.opening})})});async function c(t,_,g){if(r()||g===void 0||!g.possible.get(t)?.has(_))return;i(!0);let d=await K(g.gameId,t,_);n({gameId:g.gameId,possible:P(d.possible),board:d.board,state:d.game_state,opening:d.opening}),i(!1)}let l=()=>e()?.state==="gameResultUndefined"&&!r();return u(U,{get children(){return u(D,{get children(){return[(()=>{const t=m(te);return o(t,()=>s.title),t})(),u(ee,{get opening(){return e()?.opening},get result(){return e()?.state},get playerTurn(){return!r()}}),u(X,{get interactive(){return l()},get board(){return f()},get possible(){return e()?.possible??new Map},onMove:(t,_)=>c(t,_,e())})]}})}})};export{oe as C};
